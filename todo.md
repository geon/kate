- [x] Make vector foreach use a begin and end expression, instead of constructing it from methodPrefix and vector.
- [x] Make vector work with the struct on the stack.
- [ ] Use the vector in image.
- [x] Use the vector in sprite.
- [x] Make the background use a separate datastructure from sprite. It has no mask and must be aligned to strips.
- [x] Make spriteInstances use vector.
- [x] Separate dirty-marking loop from drawing, avoiding double marking.
- [x] Access background strips by index. Necessary to compare them efficiently.
- [x] Move sprite drawing to the sprite class.
- [ ] Cache the shifted sprites.
- [ ] Batch strip drawing in sprites.
- [ ] Batch all sprite drawing to one single draw call.
- [ ] Blend the sprites with the background in software, so the EGA masks don't need to be set.
- [ ] Draw sprites one plane at a time to avoid unnecessary plane enabling.
- [ ] Store sprites in 5 separate planes (4 color planes + mask), so they can be shifted with the same method.
- [ ] Use fixed length value arrays in the DirtyBackgroundStrips. More easily reusable like a slab allocator. Should be faster.
